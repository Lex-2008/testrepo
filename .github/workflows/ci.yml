on: push

jobs:
  test:
    runs-on: windows-2022
    steps:

      - uses: actions/checkout@v4

      - name: path
        shell: bash
        run: "echo $PATH | tr : '\\n'"

      - name: ls path
        shell: bash
        run: "echo $PATH | xargs -d: ls -la || true"

      - name: find cmake
        shell: bash
        run: "find / -name Support.cmake 2>/dev/null"

      - name: default python3
        shell: bash
        run: which python3

      - name: python3 venv
        shell: bash
        run: |
          python3 -m venv test-venv
          find test-venv
          test-venv/Scripts/python -c 'print(12)'

      - name: cmake find Python3
        run: cmake -S . -B test

      - name: cmake-found python3 venv bash
        shell: bash
        run: C:/hostedtoolcache/windows/Python/3.12.0/x64/python3.exe -m venv test2-venv

      - name: cmake-found python3 venv
        if: ${{ !cancelled() }}
        run: C:/hostedtoolcache/windows/Python/3.12.0/x64/python3.exe -m venv test3-venv

      - name: find test2
        shell: bash
        if: ${{ !cancelled() }}
        run: |
          find test2-venv
          test2-venv/Scripts/python -c 'print(12)'

      - name: find test3
        shell: bash
        if: ${{ !cancelled() }}
        run: |
          find test3-venv
          test3-venv/Scripts/python -c 'print(12)'
